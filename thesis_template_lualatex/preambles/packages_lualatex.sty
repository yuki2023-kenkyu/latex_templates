% LuaLaTeX + luatexja + bxjsreportを前提とした例
\usepackage{luatexja}
\usepackage[japanese,english]{babel} % 必要なら英語環境を有効化
\usepackage{bxorigcapt}
% ドライバ非依存でgraphicx読み込み
\usepackage{graphicx}
\usepackage{bmpsize}
\usepackage{here}
\usepackage{comment}
\usepackage{amsmath, amssymb, amsthm, physics2}
\usepackage{mathtools}
\usepackage{booktabs}

\usepackage{bookmark}
\usepackage{xurl}
% hyperrefはdvipdfmxオプションを外して使用
\usepackage{hyperref}
\hypersetup{% hyperrefオプションリスト
  unicode=true,
  colorlinks=false,
  setpagesize=false,
  bookmarksnumbered=true,%
  bookmarksopen=true,% ブックマークを開く
  hidelinks,
  % pdfusetitle
}
\usepackage{wrapfig}
\usepackage{enumerate}
\usepackage[
  format=plain,
  labelformat=simple,
  labelsep=space,
  font={bf, small}
]{caption}
\usepackage{breqn} % dmath環境などはLuaLaTeXでも利用可能
\usepackage{listings, color}
\usepackage{cleveref}
% \usepackage{autonum} % 必要なら使用可 (LuaLaTeXでも可)
\usepackage[version=4]{mhchem} % 化学式
\usepackage{siunitx} % 単位表記\usepackage{bookmark}
\usepackage{tikz-feynhand}

\usepackage{./preambles/biblatex-journal-style} % 削除または環境に応じて修正
% biblatexはbiberバックエンドで問題なし
\usepackage{csquotes}
\usepackage[
  backend=biber,
  style=numeric,
  sorting=none
]{biblatex}

\usephysicsmodule{ab}

% cleverefの設定：日本語ラベル対応
\creflabelformat{chapter}{第#2#1#3章}
\creflabelformat{section}{#2#1#3節}
\creflabelformat{subsection}{#2#1#3小節}
\creflabelformat{subsubsection}{#2#1#3}
\crefname{section}{第}{第}
\crefname{subsection}{第}{第}

\creflabelformat{enumi}{#2（#1）#3}
\crefrangeformat{enumi}{#3（#1）#4--#5（#2）#6}
\crefmultiformat{enumi}{#2（#1）#3}{，#2（#1）#3}{，#2（#1）#3}{，#2（#1）#3}
\crefname{equation}{式}{式}
\crefname{dmath}{式}{式}

\crefname{figure}{Fig.}{Fig.}
\crefname{table}{Tab.}{Tab.}

\crefname{appendix}{付録}{付録}
\crefname{lstlisting}{プログラム}{プログラム}

% 式や章，図番号を引用時の日本語の接続詞
\newcommand{\crefpairconjunction}{と}
\newcommand{\crefrangeconjunction}{から}
\newcommand{\crefmiddleconjunction}{，}
\newcommand{\creflastconjunction}{，および}

% 日本語キャプション設定や数式番号などはそのまま利用可能
\numberwithin{equation}{chapter}
\renewcommand{\thefigure}{\thechapter.\arabic{figure}}
\renewcommand{\thetable}{\thechapter.\arabic{table}}
% 付録を参照する際のコマンド
\newcommand{\aref}[1]{付録\ref{#1}}
\newcommand{\lref}[1]{プログラム\ref{#1}}
% 付録のソースコードの出力に関する設定
\renewcommand{\lstlistingname}{プログラム} % ソースコードのキャプション名

\lstset{
  language = Python,
  %背景色と透過度
  backgroundcolor={\color[gray]{.90}},
  %枠外に行った時の自動改行
  breaklines = true,
  %自動改行後のインデント量(デフォルトでは20[pt])
  breakindent = 10pt,
  %標準の書体
  basicstyle = \ttfamily\scriptsize,
  %コメントの書体
  commentstyle = {\itshape \color[cmyk]{1,0.4,1,0}},
  %関数名等の色の設定
  classoffset = 0,
  %キーワード(int, ifなど)の書体
  keywordstyle = {\bfseries \color[cmyk]{0,1,0,0}},
  %表示する文字の書体
  stringstyle = {\ttfamily \color[rgb]{0,0,1}},
  %枠 "t"は上に線を記載, "T"は上に二重線を記載
  %他オプション：leftline，topline，bottomline，lines，single，shadowbox
  frame = TBrl,
  %frameまでの間隔(行番号とプログラムの間)
  framesep = 5pt,
  %行番号の位置
  numbers = left,
  %行番号の間隔
  stepnumber = 1,
  %行番号の書体
  numberstyle = \tiny,
  %タブの大きさ
  tabsize = 4,
  %キャプションの場所("tb"ならば上下両方に記載)
  captionpos = t
}

