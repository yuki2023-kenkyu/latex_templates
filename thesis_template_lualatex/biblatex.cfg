\ProvidesFile{biblatex.cfg}[2024/12/18 biblatex configuration for Japanese]
% スタイル読み込み
\RequireBibliographyStyle{phys}

% ===== BibLaTeX 全体のオプション設定 =====
\ExecuteBibliographyOptions{
   abbreviate=true,
   arxiv=abs,
   backref=true,
   date=year,
   doi=true,
   eprint=true,
   giveninits=true,
   isbn=false,
   maxbibnames=3,
   maxnames=3,
   minnames=1,
   seconds=false,
   sortcites=true,
   url=false,
   urldate=iso,
   useeditor=true,
}

% ===== 著者名の区別を抑制 =====
\DeclareUniquenameTemplate{
  \namepart[use=true, base=true]{prefix}
  \namepart[base=true]{family}
  \namepart[base=true]{given}
  \namepart{suffix}
}

% ===== 日本語文献の設定 =====
\AtEveryBibitem{%
  \clearfield{note}%
  \ifentrytype{book}{%
    \clearfield{edition}%
    \clearfield{pages}%
    \clearfield{price}%
    \clearfield{condition}%
    \clearfield{timestamp}%
    \clearfield{eventdate}%
    \clearfield{keywords}%
  }{}%
  
  \iffieldundef{eprint}{}{%
    \clearfield{doi}%
    \clearfield{url}%
    \clearfield{urldate}%
  }%
  
  \iffieldequalstr{langid}{japanese}{%
    \DeclareNameAlias{default}{japanese}%
    \renewcommand*{\revsdnamepunct}{}%
    
    \DeclareDelimFormat{multinamedelim}{，}%
    \DeclareDelimFormat{finalnamedelim}{，}%
    \DeclareDelimFormat{editortypedelim}{\space}%
    \renewcommand*{\newunitpunct}{\space}%
    \renewcommand*{\labelnamepunct}{\space}%
    \renewcommand*{\finentrypunct}{\space}%
    
    \DeclareNameFormat{default}{%
      \usebibmacro{name:family-given}%
         {\namepartfamily}%
         {\namepartgiven}%
         {\namepartprefix}%
         {\namepartsuffix}%
      \usebibmacro{name:andothers}%
    }%
    
    \renewbibmacro*{name:andothers}{%
      \ifboolexpr{
         test {\ifnumequal{\value{listcount}}{\value{liststop}}}
         and
         test \ifmorenames
      }
      {%
         \ifnumgreater{\value{liststop}}{1}{\finalandcomma}{}%
         \printdelim{andothersdelim}\printtext{他}%
      }
      {}%
    }%

    \renewbibmacro*{author/editor}{%
        \ifboolexpr{
            test \ifuseauthor
            and
            not test {\ifnameundef{author}}
        }
        {\usebibmacro{author}}
        {%
        \ifboolexpr{ test {\iffieldequalstr{langid}{japanese}} }
            {%
            \printnames{editor}%
            \setunit{\addspace}%
            \printtext{編}%
            }
            {\usebibmacro{editor}}%
        }%
    }

    \renewbibmacro*{author/editor+others}{%
        \ifboolexpr{
            test \ifuseauthor
            and
            not test {\ifnameundef{author}}
        }
        {\usebibmacro{author}}
        {%
        \ifboolexpr{ test {\iffieldequalstr{langid}{japanese}} }
            {%
            \printnames{editor}%
            \setunit{\addspace}%
            \printtext{編}%
            }
            {\usebibmacro{editor+others}}%
        }%
    }

    % --- 編集者(複数名)用末尾文字列の再定義 ---
    \renewbibmacro*{editor+othersstrg}{%
        \iffieldequalstr{langid}{japanese}
            {\printtext{編}}
            {\printtext{\bibstring{editor}}}%
    }

    \renewbibmacro*{bytranslator}{%
      \ifnameundef{translator}
        {}
        {\printnames[bytranslator]{translator}\printtext{訳}}%
    }%
    \renewbibmacro*{bytranslator+others}{\usebibmacro{bytranslator}}%
    
    \renewbibmacro*{byeditor}{%
      \ifnameundef{editor}
        {}
        {\printnames[byeditor]{editor}\printtext{編}}%
    }%
    \renewbibmacro*{byeditor+others}{\usebibmacro{byeditor}}%
    
    \DeclareFieldFormat*{title}{「#1」}%
    \DeclareFieldFormat[book]{title}{『#1』}%
    \DeclareFieldFormat*{journaltitle}{\textmd{#1}}%
    \DeclareFieldAlias{booktitle}[book]{title}%
    
    \DeclareFieldFormat{year}{#1}%
    \renewbibmacro*{publisher+location+date}{%
      \printtext{%
        \newunit%
        (\printlist{publisher}，\printfield{year})%
        \newunit%
      }%
    }%
  }{%
    \DeclareFieldFormat{journaltitle}{\mkbibemph{#1}}%
    \DeclareFieldAlias{booktitle}{journaltitle}%
    \newcommand*{\mkandothers}{\mkbibemph}%
    \renewbibmacro*{name:andothers}{%
      \ifboolexpr{
         test {\ifnumequal{\value{listcount}}{\value{liststop}}}
         and
         test \ifmorenames
      }
      {%
         \ifnumgreater{\value{liststop}}{1}{\finalandcomma}{}%
         \andothersdelim\bibstring[\mkandothers]{andothers}%
      }
      {}%
    }%
  }%
}

% ==== 共通設定: "in:" の削除、volume の太字化 ====
\renewbibmacro{in:}{}%
\DeclareFieldFormat*{volume}{\textbf{#1}\addcolon\space}

\endinput
