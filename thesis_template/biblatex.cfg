\ProvidesFile{biblatex.cfg}[2023/04/10 biblatex configuration for Japanese]

\ExecuteBibliographyOptions{
   sortcites=true,%\cite{}の中に書いた順番通りの出力する(falseなら並び替えない)
   date=year,%dateの表示はyearのみにする
   urldate=iso,%urldateの表示はyyyy-mm-ddにする
   seconds=true,
   maxnames=3,%著者がmaxnamesを超えるときminnamesの数まで省略する
   minnames=1,
   %maxbibnames=3,%参考文献では99人まで著者を載せる
   %backref=true,%引用したページを文献リストに表示する
   %backrefstyle=none,%ページが連続するときの省略(デフォルトでthree)。省略させたくないときはnoneにする
   abbreviate=true,
   isbn=false,%isbnを出力しない
   url=false,
   doi=true,
   arxiv=abs,
   eprint=true,
   backref=true
}

% %%% 著者名の区別を抑制
\DeclareUniquenameTemplate{
  \namepart[use=true, base=true]{prefix}
  \namepart[base=true]{family}
  \namepart[base=true]{given}
  \namepart{suffix}
}

% ==== 2名の場合のandを太字にしないためのデリミタ再定義 ====
% 英語・日本語共通でデフォルトを再定義
\DeclareDelimFormat{multinamedelim}{\addcomma\space}
\DeclareDelimFormat{finalnamedelim}{\addspace and\addspace} % andを太字にしない
\DeclareFieldFormat*{volume}{\textbf{#1}\addcolon\space} %volumeを太字へ
\renewbibmacro{in:}{} % in: Some journal の "in:" を取る

% ==== 追加: 言語別の文字列再定義 ====
\DefineBibliographyStrings{english}{
  andothers    = {et~al.},   % 英語文献での省略表記を"et al."に
  byeditor     = {Ed.},       % 編集者の表記を"Ed."に
  pages        = {p.},       % ページ数の表記を"p."に
  backrefpage  = {cit. on p.},       % backrefpageの表記を短く
  backrefpages = {cit. on pp.}
}

% andothersを常に言語に応じて出力させるマクロ
%\renewbibmacro*{name:andothers}{\bibstring{andothers}}

% 参考文献リストでの表記を設定
\AtEveryBibitem{%
  \ifentrytype{book}{%
    \clearfield{edition}
    \clearfield{pages}
  }{}

  \iffieldundef{eprint}{}{%
    \clearfield{doi}%
    \clearfield{url}%
    \clearfield{urldate}}%

  % langidがjapaneseの場合の処理
  \iffieldequalstr{langid}{japanese}{
     \DeclareNameAlias{default}{japanese}% 
     \DeclareNameAlias{sortname}{japanese}%
     \renewcommand*{\revsdnamepunct}{}% 姓と名の間のコンマを消去
     \DeclareDelimFormat{multinamedelim}{，}% 著者名の区切り文字を「，」に
     \DeclareDelimFormat{finalnamedelim}{，}% 著者名の最後の区切り文字も「，」

     % 名前を「姓 名」の順に
     \DeclareNameFormat{default}{%
       \usebibmacro{name:delim}{\namepartfamily\namepartgiven}%
       \usebibmacro{name:hook}{\namepartfamily\namepartgiven}%
       \namepartfamily\bibnamedelimc\namepartgiven%
       \usebibmacro{name:andothers}
     }

     % 著者の省略表記
     \renewbibmacro*{name:andothers}{%
       \iflanguage{japanese}{\addspace 他}{et al\adddot}}

     % 翻訳者の表記
     \renewbibmacro*{bytranslator}{%
       \ifnameundef{translator}
       {}
       {\printnames[bytranslator]{translator}\printtext[parens]{訳}}}
     \renewbibmacro*{bytranslator+others}{\usebibmacro{bytranslator}}%

     % 編集者の表記
     \renewbibmacro*{byeditor}{%
       \ifnameundef{editor}
       {}
       {\printnames{editor}\printtext[parens]{編}}}
     \renewbibmacro*{byeditor+others}{\usebibmacro{byeditor}}%

     % タイトルの書式
     \DeclareFieldFormat*{title}{「#1」 } % タイトルを「」で囲む（非book系）
     \DeclareFieldFormat[book]{title}{『#1』}% 本のタイトルを『』で囲む
     \DeclareFieldAlias{booktitle}[book]{title}% 文献を収録する本のタイトルを『』で囲む
     \DeclareFieldAlias{journaltitle}[book]{title}% 雑誌名を『』で囲む
     \renewbibmacro{in:}{}% In:を削除

     % 日本語文献の場合、出版社名+場所+年(括弧)
     \DeclareFieldFormat{year}{(#1)}
     \renewbibmacro*{publisher+location+date}{%
       \printlist{publisher}%
       \setunit*{\addspace}% コロン削除
       \printlist{location}%
       \setunit*{\addspace}%
       \printfield{year}%
     }
  }{
    % 上記以外（英語など）の文献の場合はデフォルトでjournaltitleをイタリックに
    \DeclareFieldFormat{journaltitle}{\emph{#1}}

  }
}

\endinput
